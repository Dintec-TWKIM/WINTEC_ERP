USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_PR_DEPT_EQUIP_MNG_S2]    Script Date: 2019-03-26 오전 11:26:39 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[SP_CZ_PR_DEPT_EQUIP_MNG_S2]
(
    @P_CD_COMPANY   NVARCHAR(7),
	@P_NO_WO		NVARCHAR(20)
)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT WO.NO_WO,
	   MP.LN_PARTNER,
	   SH.NO_PO_PARTNER,
	   SH.DT_SO,
	   CD.NM_SYSDEF AS NM_ENGINE,
	   MI.NM_ITEM,
	   SL.TXT_USERDEF6 AS NO_HULL,
	   SH.NO_SO,
	   MI.NO_DESIGN,
	   WM.QT_APPLY,
	   SL.QT_SO,
	   MI.UNIT_SO,
	   CD1.NM_SYSDEF AS NM_CERT,
	   SL.DT_DUEDATE,
	   SL.DT_REQGI
FROM PR_WO WO
JOIN CZ_PR_SA_SOL_PR_WO_MAPPING WM ON WM.CD_COMPANY = WO.CD_COMPANY AND WM.CD_PLANT = WO.CD_PLANT AND WM.NO_WO = WO.NO_WO
JOIN SA_SOL SL ON SL.CD_COMPANY = WM.CD_COMPANY AND SL.NO_SO = WM.NO_SO AND SL.SEQ_SO = WM.NO_LINE
JOIN SA_SOH SH ON SH.CD_COMPANY = SL.CD_COMPANY AND SH.NO_SO = SL.NO_SO
LEFT JOIN MA_PARTNER MP ON MP.CD_COMPANY = SH.CD_COMPANY AND MP.CD_PARTNER = SH.CD_PARTNER
LEFT JOIN MA_PITEM MI ON MI.CD_COMPANY = WO.CD_COMPANY AND MI.CD_PLANT = WO.CD_PLANT AND MI.CD_ITEM = WO.CD_ITEM
LEFT JOIN MA_CODEDTL CD ON CD.CD_COMPANY = SL.CD_COMPANY AND CD.CD_FIELD = 'CZ_WIN0003' AND CD.CD_SYSDEF = SL.CD_USERDEF3
LEFT JOIN MA_CODEDTL CD1 ON CD1.CD_COMPANY = SL.CD_COMPANY AND CD1.CD_FIELD = 'CZ_WIN0001' AND CD1.CD_SYSDEF = SL.CD_USERDEF1
WHERE WO.CD_COMPANY = @P_CD_COMPANY
AND WO.NO_WO = @P_NO_WO

GO

