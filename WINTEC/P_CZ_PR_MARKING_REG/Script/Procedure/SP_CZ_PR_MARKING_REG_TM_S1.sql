USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_PR_MARKING_REG_TM_S1]    Script Date: 2022-09-13 오후 4:52:59 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


ALTER PROCEDURE [NEOE].[SP_CZ_PR_MARKING_REG_TM_S1]          
(
	@P_CD_COMPANY		NVARCHAR(7),
	@P_NO_SO			NVARCHAR(20),
	@P_SEQ_SO			NUMERIC(5, 0),
	@P_CD_MATL			NVARCHAR(20)
)
AS
   
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET NOCOUNT ON

SELECT TOP 1
	TW.NO_SO,
	TW.SEQ_SO,
	TW.IDX AS NO_LINE,
	TW.CD_ITEM AS CD_MATL,
	MI.NM_ITEM,
	MI.NO_DESIGN,
	TW.NO_TRUST,
	TW.NO_TRUST AS CD_QR,
	TW.NO_TRUST AS DC_TEXT
FROM CZ_SA_SOL_TRUST_WINTEC TW
LEFT JOIN MA_PITEM MI ON MI.CD_COMPANY = TW.CD_COMPANY AND MI.CD_ITEM = TW.CD_ITEM
WHERE TW.CD_COMPANY = @P_CD_COMPANY
AND TW.NO_SO = @P_NO_SO
AND TW.SEQ_SO = @P_SEQ_SO
AND TW.CD_ITEM = @P_CD_MATL
AND ISNULL(TW.YN_TRUST, 'N') != 'Y'
AND ISNULL(TW.NO_ID,'') = ''
ORDER BY TW.IDX

GO


