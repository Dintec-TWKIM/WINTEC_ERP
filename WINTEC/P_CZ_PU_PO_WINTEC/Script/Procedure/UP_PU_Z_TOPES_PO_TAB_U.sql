USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[UP_PU_Z_TOPES_PO_TAB_U]    Script Date: 2022-03-24 오후 6:05:19 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[UP_PU_Z_TOPES_PO_TAB_U]
(
	@P_CD_COMPANY  	 NVARCHAR(7),    
	@P_CD_PLANT		 NVARCHAR(7),     
	@P_NO_PO       	 NVARCHAR(20),     
	@P_NO_SEQ      	 NUMERIC(5, 0),     
	@P_FG_IV       	 NVARCHAR(3),      
	@P_DT_IV_PLAN  	 NVARCHAR(8),     
	@P_RT_IV       	 NUMERIC(19, 6),     
	@P_AM            NUMERIC(17, 4),     
	@P_VAT           NUMERIC(17, 4),
	@P_DT_BAN_PLAN   NVARCHAR(8),  
	@P_RT_BAN		 NUMERIC(19, 6),
	@P_AM_BAN		 NUMERIC(17, 4),
	@P_AM_BANK		 NUMERIC(17, 4),
	@P_SERVER_KEY	 NVARCHAR(25),
	@P_ID_UPDATE	 NVARCHAR(15)
)
AS
DECLARE	@ERRNO   INT, 
		@ERRMSG	 NVARCHAR(255),
		@DTS_INSERT NVARCHAR(14)
SELECT @DTS_INSERT = REPLACE(REPLACE(REPLACE(CONVERT(VARCHAR(20), GETDATE(), 120), '-',''), ' ', ''),':','')     



UPDATE PU_CUST_PUBLIC
SET CD_1 = @P_FG_IV,
	DT_1 = @P_DT_IV_PLAN,
	UM_RT_ETC_1 = @P_RT_IV,
	AM_1 = @P_AM,
	AM_2 = @P_VAT,
	DT_2 = @P_DT_BAN_PLAN,
	UM_RT_ETC_2 = @P_RT_BAN,
	AM_3 = @P_AM_BAN,
	SQ_1 = @P_NO_SEQ,
	AM_4 = @P_AM_BANK,
	ID_UPDATE = @P_ID_UPDATE,
	DTS_UPDATE = @DTS_INSERT
		
WHERE CD_NO_PK_1 = @P_CD_COMPANY
  AND CD_NO_PK_2 = @P_NO_PO
  AND CD_NO_PK_4 = @P_NO_SEQ
  AND NM_BUSINESS = 'P_PU_PO_REG2'
  AND CD_CUST_SERVER_KEY = @P_SERVER_KEY


IF (@@ERROR <> 0 ) BEGIN SELECT @ERRNO  = 100000, @ERRMSG = '작업을정상적으로처리하지못했습니다.' GOTO ERROR END

RETURN
ERROR: RAISERROR (@ERRMSG,18,1)
GO


