USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_PR_POP_REG_SUB1_S]    Script Date: 2017-01-05 오후 5:48:55 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[SP_CZ_PR_POP_REG_SUB1_INSP]          
(
	@P_CD_COMPANY		NVARCHAR(7),
    @P_CD_PLANT			NVARCHAR(7),
	@P_NO_WO			NVARCHAR(20),
	@P_NO_LINE			NUMERIC(5, 0)
)  
AS
   
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT RI.NO_INSP,
       RI.DC_ITEM,
       RI.CD_MEASURE,
       RI.DC_LOCATION,
       RI.DC_SPEC,
       ROUND(CAST(RI.QT_MIN AS DECIMAL), 0) AS MIN_VALUE,
       ROUND(CAST(RI.QT_MAX AS DECIMAL), 0) AS MAX_VALUE,
       RI.TP_DATA,
       CONVERT(CHAR(1), RI.CNT_INSP) AS CNT_INSP,
       RI.YN_CERT
FROM PR_WO WO
JOIN PR_WO_ROUT WR ON WR.CD_COMPANY = WO.CD_COMPANY AND WR.CD_PLANT = WO.CD_PLANT AND WR.NO_WO = WO.NO_WO
JOIN CZ_PR_ROUT_INSP RI ON RI.CD_COMPANY = WO.CD_COMPANY AND RI.CD_PLANT = WO.CD_PLANT AND RI.CD_ITEM = WO.CD_ITEM AND RI.NO_OPPATH = WO.PATN_ROUT AND RI.CD_OP = WR.CD_OP AND RI.CD_WCOP = WR.CD_WCOP
WHERE WO.CD_COMPANY = @P_CD_COMPANY
AND WO.CD_PLANT = @P_CD_PLANT
AND WO.NO_WO = @P_NO_WO
AND WR.NO_LINE = @P_NO_LINE
AND ISNULL(RI.YN_USE, 'N') = 'Y'
ORDER BY RI.NO_INSP

GO