USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_PU_ADPAYMENT_BILL_SCH_S]    Script Date: 2015-08-06 오후 3:48:06 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


ALTER PROCEDURE [NEOE].[SP_CZ_PU_ADPAYMENT_BILL_SCH_S]
(
	@CD_COMPANY		NVARCHAR(7),
	@DT_FROM		NVARCHAR(8),
	@DT_TO			NVARCHAR(8),
	@FG_TRANS		NVARCHAR(3),        
	@CD_SUPPLIER	NVARCHAR(20),
	@NO_EMP		    NVARCHAR(7),
	@CD_PURGRP		NVARCHAR(7)
)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT BH.CD_COMPANY,
	   BH.NO_BILLS,
	   BH.DT_BILLS,
	   ISNULL(BH.AM_BILLS, 0) AS AM_BILLS,
	   ISNULL(BH.AM_IV, 0) AS AM_IV,
	   BH.CD_PARTNER,
	   MP.LN_PARTNER AS NM_PARTNER,
	   BH.CD_BILLTGRP,
	   PG.NM_PURGRP AS NM_BILLTGRP,
	   BH.NO_EMP,
	   ME.NM_KOR
FROM CZ_PU_ADPAYMENT_BILL_H BH
LEFT JOIN MA_PARTNER MP ON MP.CD_COMPANY = BH.CD_COMPANY AND MP.CD_PARTNER = BH.CD_PARTNER
LEFT JOIN MA_PURGRP PG ON PG.CD_COMPANY = BH.CD_COMPANY AND PG.CD_PURGRP = BH.CD_BILLTGRP
LEFT JOIN MA_EMP ME ON ME.CD_COMPANY = BH.CD_COMPANY AND ME.NO_EMP = BH.NO_EMP
WHERE BH.CD_COMPANY = @CD_COMPANY
AND BH.DT_BILLS BETWEEN @DT_FROM AND @DT_TO
AND BH.TP_BUSI = @FG_TRANS
AND (ISNULL(@CD_SUPPLIER, '') = '' OR BH.CD_PARTNER = @CD_SUPPLIER)
AND (ISNULL(@CD_PURGRP, '') = '' OR BH.CD_BILLTGRP = @CD_PURGRP)
AND (ISNULL(@NO_EMP, '') = '' OR BH.NO_EMP = @NO_EMP)

GO