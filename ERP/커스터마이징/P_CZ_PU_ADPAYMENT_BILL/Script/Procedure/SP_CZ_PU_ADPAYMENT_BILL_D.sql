USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_PU_ADPAYMENT_BILL_D]    Script Date: 2015-08-06 오후 1:07:29 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO


ALTER PROCEDURE [NEOE].[SP_CZ_PU_ADPAYMENT_BILL_D] 
(
	@P_CD_COMPANY         NVARCHAR(7),
	@P_NO_BILLS           NVARCHAR(20)
)
AS

DECLARE @V_ERRNO           INT,
        @V_ERRMSG          NVARCHAR(255)

DELETE FROM CZ_PU_ADPAYMENT_BILL_D
WHERE CD_COMPANY = @P_CD_COMPANY
AND NO_BILLS   = @P_NO_BILLS

IF (@@ERROR <> 0 )  
BEGIN    
    SELECT @V_ERRNO  =  100000, 
        @V_ERRMSG = '작업을 정상적으로 처리하지 못했습니다.' 
    GOTO ERROR
END

DELETE FROM CZ_PU_ADPAYMENT_BILL_L
WHERE CD_COMPANY = @P_CD_COMPANY
AND NO_BILLS = @P_NO_BILLS

IF (@@ERROR <> 0 )  
BEGIN    
    SELECT @V_ERRNO  =  100000, 
        @V_ERRMSG = '작업을 정상적으로 처리하지 못했습니다.' 
    GOTO ERROR
END


DELETE FROM CZ_PU_ADPAYMENT_BILL_H
WHERE CD_COMPANY = @P_CD_COMPANY
AND NO_BILLS = @P_NO_BILLS

IF (@@ERROR <> 0 )  
BEGIN    
    SELECT @V_ERRNO  =  100000, 
        @V_ERRMSG = '작업을 정상적으로 처리하지 못했습니다.' 
    GOTO ERROR
END

RETURN

ERROR:    
    ROLLBACK TRAN
    RAISERROR (@V_ERRMSG, 18 , 1)
GO

