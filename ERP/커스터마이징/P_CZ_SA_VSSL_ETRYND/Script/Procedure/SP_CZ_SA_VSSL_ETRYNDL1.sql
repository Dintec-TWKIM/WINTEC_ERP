USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_SA_VSSL_ETRYNDL1]    Script Date: 2018-11-26 오후 3:09:15 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



ALTER PROCEDURE [NEOE].[SP_CZ_SA_VSSL_ETRYNDL1]
(
    @P_CD_PRTAG			    NVARCHAR(3),
    @P_DT_ETRYPT_YEAR		NVARCHAR(4),
    @P_CNT_ETRYPT			NVARCHAR(3),
    @P_CLSGN				NVARCHAR(10),
    @P_NM_VSSL				NVARCHAR(20)
)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT VL.CD_PRTAG,
	   VL.DT_ETRYPT_YEAR,
	   VL.CNT_ETRYPT,
	   VL.CLSGN,
	   VL.NM_VSSL,

	   VL.NM_ETRYND,
	   VL.DTS_ETRYPT,
	   VL.DTS_TKOFF,
	   VL.NM_IBOBPRT,
	   VL.CD_LAIDUPFCLTY,
	   VL.CD_LAIDUPFCLTY_SUB,
	   VL.NM_LAIDUPFCLTY,
	   VL.YN_PILTG,
	   VL.CD_LDADNG_FRGHT_CL,
	   MC.NM_SYSDEF AS NM_LDADNG_FRGHT_CL,
	   VL.TON_LDADNG,
	   VL.TON_TRNPDT,
	   VL.TON_LANDNG_FRGHT,
	   VL.TON_LD_FRGHT,
	   VL.GRTG,
	   VL.INTRL_GRTG,
	   VL.NM_SATMN_ENTRPS,
	   VL.CNT_CREW,
	   VL.CNT_KORAN_CREW,
	   VL.CNT_FRGNR_CREW
FROM CZ_SA_VSSL_ETRYNDL VL
LEFT JOIN MA_CODEDTL MC ON MC.CD_COMPANY = 'K100' AND MC.CD_FIELD = 'CZ_MA00026' AND MC.CD_SYSDEF = VL.CD_LDADNG_FRGHT_CL
WHERE VL.CD_PRTAG = @P_CD_PRTAG
AND VL.DT_ETRYPT_YEAR = @P_DT_ETRYPT_YEAR
AND VL.CNT_ETRYPT = @P_CNT_ETRYPT
AND VL.CLSGN = @P_CLSGN
AND VL.NM_VSSL = @P_NM_VSSL


GO

