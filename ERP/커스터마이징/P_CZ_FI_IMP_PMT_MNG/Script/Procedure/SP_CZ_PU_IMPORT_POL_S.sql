USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_PU_IMPORT_POL_S]    Script Date: 2015-08-12 오후 3:03:52 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[SP_CZ_PU_IMPORT_POL_S] 
(
	@P_CD_COMPANY		NVARCHAR(7),
	@P_NO_IMPORT		NVARCHAR(30)
) 
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT IH.NO_IMPORT,
       PH.NO_PO,
       PL.NO_LINE,
       QL.NO_DSP,
       QL.CD_ITEM_PARTNER,
       QL.NM_ITEM_PARTNER,
       PL.CD_UNIT_MM,
       PL.QT_PO,
       PL.UM_EX,
       PL.AM_EX,
       PL.UM,
       PL.AM,
       PL.VAT,
       PL.YN_BL      
FROM CZ_PU_IMPORT_DECLARATIONH IH
JOIN PU_POH PH ON PH.CD_COMPANY = IH.CD_COMPANY AND PH.NO_BL LIKE '%' + IH.NO_BL + '%' AND ISNULL(IH.NO_BL, '') <> ''
JOIN PU_POL PL ON PL.CD_COMPANY = PH.CD_COMPANY AND PL.NO_PO = PH.NO_PO
LEFT JOIN CZ_SA_QTNL QL ON QL.CD_COMPANY = PL.CD_COMPANY AND QL.NO_FILE = PL.NO_SO AND QL.NO_LINE = PL.NO_SOLINE
WHERE IH.CD_COMPANY = @P_CD_COMPANY
AND IH.NO_IMPORT = @P_NO_IMPORT

GO