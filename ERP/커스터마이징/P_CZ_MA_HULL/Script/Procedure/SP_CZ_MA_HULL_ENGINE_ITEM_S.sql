USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_MA_ENGINE_PARTS_S]    Script Date: 2015-07-29 오후 1:10:15 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



ALTER PROCEDURE [NEOE].[SP_CZ_MA_HULL_ENGINE_ITEM_S]
(
	@P_CD_COMPANY      NVARCHAR(7),
	@P_NO_IMO          NVARCHAR(10),
	@P_NO_ENGINE	   INT,
	@P_YN_INTRA	       NVARCHAR(1),
	@P_YN_UPLOAD	   NVARCHAR(1)
) 
AS 

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT EI.NO_IMO,
	   EI.NO_ENGINE,
	   EI.NO_PLATE,
	   EI.NO_PLATE_ORG,
	   EI.NM_PLATE,
	   EI.WEIGHT,
	   EI.UNIT,
	   MC.NM_SYSDEF AS NM_UNIT,
	   EI.CD_ITEM,
	   MI.NM_ITEM,
	   EI.KCODE AS EZCODE,
	   EI.KCODE2 AS EZCODE2,
	   EI.UCODE,
	   EI.NO_POSITION,
	   EI.QT_PLATE,
	   EI.DC_RMK,
	   EI.YN_UPLOAD,
	   EI.DTS_UPLOAD,
	   EI.ID_INSERT,
	   EI.DTS_INSERT,
	   EI.ID_UPDATE,
	   EI.DTS_UPDATE
FROM CZ_MA_HULL_ENGINE_ITEM EI
LEFT JOIN MA_PITEM MI ON MI.CD_COMPANY = @P_CD_COMPANY AND MI.CD_ITEM = EI.CD_ITEM
LEFT JOIN MA_CODEDTL MC ON MC.CD_COMPANY = @P_CD_COMPANY AND MC.CD_FIELD = 'MA_B000004' AND MC.CD_SYSDEF = EI.UNIT
WHERE EI.NO_IMO = @P_NO_IMO
AND EI.NO_ENGINE = @P_NO_ENGINE
AND (@P_YN_UPLOAD = 'N' OR EI.YN_UPLOAD = 'Y')

GO