USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_MA_HULL_VENDOR_ITEM_S]    Script Date: 2015-07-29 오후 1:10:15 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



ALTER PROCEDURE [NEOE].[SP_CZ_MA_HULL_VENDOR_ITEM_S]
(
	@P_CD_COMPANY      NVARCHAR(7),
	@P_NO_IMO          NVARCHAR(10),
	@P_CD_VENDOR	   NVARCHAR(20),
	@P_NO_TYPE		   INT
) 
AS 

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT TI.NO_IMO,
	   TI.CD_VENDOR,
	   TI.NO_TYPE,
	   TI.NO_ITEM,
	   TI.CD_ITEM,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.NO_PART ELSE ISNULL(MI.STND_ITEM, TI.NO_PART) END) AS NO_PART,
	   ISNULL(MI.NM_ITEM, TI.NM_PART) AS NM_PART,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.DC_MODEL ELSE ISNULL(MI.DC_MODEL, TI.DC_MODEL) END)  AS DC_MODEL,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.NO_POS ELSE ISNULL(MI.MAT_ITEM, TI.NO_POS) END)  AS NO_POS,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.UCODE ELSE ISNULL(MI.STND_DETAIL_ITEM, TI.UCODE) END) AS UCODE,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.UCODE2 ELSE ISNULL(MI.UCODE2, TI.UCODE2) END) AS UCODE2,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.NO_DRAWING ELSE ISNULL(MI.NO_STND, TI.NO_DRAWING) END) AS NO_DRAWING,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.NO_DRAWING2 ELSE ISNULL(MI.KCODE2, TI.NO_DRAWING2) END) AS NO_DRAWING2,
	   (CASE WHEN CD_VENDOR = '02428' THEN TI.UNIT ELSE ISNULL(MI.UNIT_IM, TI.UNIT) END) AS UNIT,
	   TI.QT_ITEM,
	   MI.DC_RMK AS DC_RMK_ITEM,
	   MI.DC_RMK1 AS DC_RMK1_ITEM,
	   TI.DC_RMK,
	   TI.DC_RMK1,
	   TI.DC_RMK2,
	   TI.DC_RMK3,
	   TI.DC_RMK4,
	   TI.DC_RMK5,
	   TI.DC_RMK6,
	   TI.DC_RMK7,
	   TI.DC_RMK8,
	   TI.DC_RMK9,
	   TI.DC_RMK10
FROM CZ_MA_HULL_VENDOR_ITEM TI
LEFT JOIN MA_PITEM MI ON MI.CD_COMPANY = @P_CD_COMPANY AND MI.CD_ITEM = TI.CD_ITEM
WHERE TI.NO_IMO = @P_NO_IMO
AND TI.CD_VENDOR = @P_CD_VENDOR
AND TI.NO_TYPE = @P_NO_TYPE
ORDER BY TI.CD_ITEM

GO