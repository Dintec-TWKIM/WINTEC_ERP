USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_MA_HULL_VENDOR_S]    Script Date: 2016-05-31 오전 9:15:58 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO



ALTER PROCEDURE [NEOE].[SP_CZ_MA_HULL_VENDOR_S]
(
	@P_CD_COMPANY      NVARCHAR(7),
	@P_NO_IMO          NVARCHAR(10),
	@P_CD_VENDOR	   NVARCHAR(20),
	@P_YN_LEADER	   NVARCHAR(1),
	@P_YN_ENG		   NVARCHAR(1)
) 
AS
 
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT HS.NO_IMO,
	   HS.CD_VENDOR,
	   MP.LN_PARTNER AS NM_VENDOR
FROM CZ_MA_HULL_VENDOR HS
LEFT JOIN MA_PARTNER MP ON MP.CD_COMPANY = @P_CD_COMPANY AND MP.CD_PARTNER = HS.CD_VENDOR
WHERE HS.NO_IMO = @P_NO_IMO
AND (ISNULL(@P_CD_VENDOR, '') = '' OR HS.CD_VENDOR = @P_CD_VENDOR)
AND (ISNULL(@P_YN_LEADER, '') = 'N' OR HS.CD_VENDOR NOT IN (SELECT CD_SYSDEF 
															FROM CZ_MA_CODEDTL
															WHERE CD_COMPANY = 'K100'
															AND CD_FIELD = 'CZ_MA00051'
															AND YN_USE = 'Y'))
AND (ISNULL(@P_YN_ENG, '') = 'N' OR HS.CD_VENDOR = '02428')

GO

