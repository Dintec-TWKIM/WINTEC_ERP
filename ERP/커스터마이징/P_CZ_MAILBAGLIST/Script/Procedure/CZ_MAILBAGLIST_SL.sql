USE [NEOE]
GO
/****** Object:  StoredProcedure [NEOE].[CZ_MAILBAGLIST_SL]    Script Date: 2023-05-03 오후 4:46:04 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[CZ_MAILBAGLIST_SL]
		@P_DT_ACCT		NVARCHAR(10),
		@P_CD_SEND		NVARCHAR(8)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET NOCOUNT ON

SELECT DISTINCT
	A.CD_SEND,
	A.DT_ACCT,
	A.SEQ,
	A.NM_ITEM,
	A.QT,
	A.NO_EMP_SEND,
	MP1.NM_KOR AS NM_KOR_SEND,
	A.NO_EMP_RECEIVE,
	MP2.NM_KOR AS NM_KOR_RECEIVE,
	A.NO_EMP_INSPECT,
	MP3.NM_KOR AS NM_KOR_INSPECT,
	A.DC_RMK,
	A.DTS_UPDATE,
	A.ID_UPDATE,
	A.DTS_INSERT,
	A.ID_INSERT,
	B.NM_SYSDEF
FROM CZ_MAILBAGLIST_L AS A
LEFT JOIN CZ_MAILBAGLIST_H AS C ON A.CD_SEND = C.CD_SEND AND A.DT_ACCT = C.DT_ACCT
LEFT JOIN MA_EMP MP1 ON A.NO_EMP_SEND = MP1.NO_EMP AND (MP1.CD_COMPANY ='k100' OR MP1.CD_COMPANY ='k200')
LEFT JOIN MA_EMP MP2 ON A.NO_EMP_RECEIVE = MP2.NO_EMP AND (MP2.CD_COMPANY ='k100' OR MP2.CD_COMPANY ='k200')
LEFT JOIN MA_EMP MP3 ON A.NO_EMP_INSPECT = MP3.NO_EMP AND (MP3.CD_COMPANY ='k100' OR MP3.CD_COMPANY ='k200')
LEFT JOIN CZ_MA_CODEDTL B ON B.CD_FIELD = 'CZ_MM00004' AND A.CD_SEND = B.CD_SYSDEF
WHERE A.DT_ACCT = @P_DT_ACCT
AND A.CD_SEND = @P_CD_SEND
ORDER BY A.SEQ ASC
--ASC 오름차순 DESC 내림차순