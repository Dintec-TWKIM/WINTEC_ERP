USE [NEOE]
GO
/****** Object:  StoredProcedure [NEOE].[CZ_MAILBAGLIST_SH]    Script Date: 2023-05-03 오후 4:45:58 ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[CZ_MAILBAGLIST_SH]
		@P_CD_SEND		NVARCHAR(8),
		@P_DT_FROM		NVARCHAR(8),
	    @P_DT_TO		NVARCHAR(8)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED
SET NOCOUNT ON

SELECT
	A.CD_COMPANY,
	A.NO_EMP,
	A.CD_SEND,
	A.DT_ACCT,
	B.NM_SYSDEF
FROM CZ_MAILBAGLIST_H AS A
LEFT JOIN CZ_MA_CODEDTL B ON B.CD_FIELD = 'CZ_MM00004' AND A.CD_SEND = B.CD_SYSDEF
WHERE A.CD_SEND = @P_CD_SEND
AND A.DT_ACCT BETWEEN @P_DT_FROM AND @P_DT_TO
GROUP BY A.CD_COMPANY,A.NO_EMP,A.DT_ACCT, A.CD_SEND, B.NM_SYSDEF
ORDER BY A.DT_ACCT DESC
--ASC 오름차순 DESC 내림차순