USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_LN_CURR_YEAR]    Script Date: 2019-06-07 오후 4:44:54 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO




ALTER PROCEDURE [NEOE].[SP_CZ_LN_CURR_YEAR]
(
	@P_YEAR			NVARCHAR(8),
	@P_GDP_K		NVARCHAR(50),
	@P_GDP_US		NVARCHAR(50)
)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

IF EXISTS (SELECT 1 
		   FROM CZ_LN_CURR_YEAR
		   WHERE YEAR = @P_YEAR)
BEGIN
	UPDATE CZ_LN_CURR_YEAR
	SET GDP_K = ISNULL(@P_GDP_K, GDP_K),
		GDP_US = ISNULL(@P_GDP_US, GDP_US),
		DTS_UPDATE = NEOE.SF_SYSDATE(GETDATE())
	WHERE YEAR = @P_YEAR
END
ELSE
BEGIN
	INSERT INTO CZ_LN_CURR_YEAR
	(
		YEAR,
		GDP_K,
		GDP_US,
		DTS_INSERT
	)
	VALUES
	(
		@P_YEAR,
		@P_GDP_K,
		@P_GDP_US,
		NEOE.SF_SYSDATE(GETDATE())
	)
END

GO

