USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_LN_CURR_DAY]    Script Date: 2019-06-07 오후 4:49:54 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO




ALTER PROCEDURE [NEOE].[SP_CZ_LN_CURR_DAY]
(
	@P_DAY			NVARCHAR(8),
	@P_YEN_EXC_R	NVARCHAR(50),
	@P_EURO_EXC_R	NVARCHAR(50),
	@P_CALL_R		NVARCHAR(50),
	@P_EXC_R		NVARCHAR(50),
	@P_KOSPI		NVARCHAR(50),
	@P_DOW_JONES	NVARCHAR(50),
	@P_NASDAQ		NVARCHAR(50),
	@P_WTI		    NVARCHAR(50)
)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

IF EXISTS (SELECT 1 
		   FROM CZ_LN_CURR_DAY
		   WHERE DAY = @P_DAY)
BEGIN
	UPDATE CZ_LN_CURR_DAY
	SET YEN_EXC_R = ISNULL(@P_YEN_EXC_R, YEN_EXC_R),
		EURO_EXC_R = ISNULL(@P_EURO_EXC_R, EURO_EXC_R),
		CALL_R = ISNULL(@P_CALL_R, CALL_R),
		EXC_R = ISNULL(@P_EXC_R, EXC_R),
		KOSPI = ISNULL(@P_KOSPI, KOSPI),
		DOW_JONES = ISNULL(@P_DOW_JONES, DOW_JONES),
		NASDAQ = ISNULL(@P_NASDAQ, NASDAQ),
		WTI = ISNULL(@P_WTI, WTI),
		DTS_UPDATE = NEOE.SF_SYSDATE(GETDATE())
	WHERE DAY = @P_DAY
END
ELSE
BEGIN
	INSERT INTO CZ_LN_CURR_DAY
	(
		DAY,
		YEN_EXC_R,
		EURO_EXC_R,
		CALL_R,
		EXC_R,
		KOSPI,
		DOW_JONES,
		NASDAQ,
		WTI,
		DTS_INSERT
	)
	VALUES
	(
		@P_DAY,
		@P_YEN_EXC_R,
		@P_EURO_EXC_R,
		@P_CALL_R,
		@P_EXC_R,
		@P_KOSPI,
		@P_DOW_JONES,
		@P_NASDAQ,
		@P_WTI,
		NEOE.SF_SYSDATE(GETDATE())
	)
END

GO

