USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_SA_CUST_REL_MNG_PIC_COMMENT_S]    Script Date: 2017-06-08 오후 7:52:31 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO




ALTER PROCEDURE [NEOE].[SP_CZ_SA_MEETING_MEMO_S]
(
	@P_CD_COMPANY	NVARCHAR(7),
	@P_DT_START		NVARCHAR(8),
	@P_DT_END		NVARCHAR(8),
	@P_CD_PARTNER	NVARCHAR(20),
	@P_NO_MEETING	NVARCHAR(20),
	@P_ID_INSERT	NVARCHAR(15)
) 
AS
 
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT 'N' AS S,
	   MT.CD_COMPANY,
	   MT.NO_MEETING,
	   MT.CD_PARTNER,
	   MP.LN_PARTNER,
	   MT.DT_MEETING,
	   MT.DC_TIME,
	   MT.DC_LOCATION,
	   MT.DC_SUBJECT,
	   MT.DC_PURPOSE,
	   MT.DC_MEETING,
	   MT.NO_GW_DOCU,
	   GW.APP_DOC_ID AS ID_GW_DOCU,
	   GW.ST_STAT AS CD_GW_STAT,
	   MC.NM_SYSDEF AS NM_GW_STAT,
	   GW.ID_WRITE,
	   MT.ID_INSERT,
	   MU.NM_USER AS NM_INSERT
FROM CZ_SA_MEETING_MEMO MT
LEFT JOIN MA_PARTNER MP ON MP.CD_COMPANY = MT.CD_COMPANY AND MP.CD_PARTNER = MT.CD_PARTNER
LEFT JOIN FI_GWDOCU GW ON GW.CD_COMPANY = 'K100' AND GW.CD_PC = '010000' AND GW.NO_DOCU = MT.CD_COMPANY + '-' + MT.NO_GW_DOCU
LEFT JOIN MA_CODEDTL MC ON MC.CD_COMPANY = GW.CD_COMPANY AND MC.CD_FIELD = 'PU_C000065' AND MC.CD_SYSDEF = GW.ST_STAT
LEFT JOIN MA_USER MU ON MU.CD_COMPANY = MT.CD_COMPANY AND MU.ID_USER = MT.ID_INSERT
WHERE MT.CD_COMPANY = @P_CD_COMPANY
AND MT.DT_MEETING BETWEEN @P_DT_START AND @P_DT_END
AND (ISNULL(@P_CD_PARTNER, '') = '' OR MT.CD_PARTNER = @P_CD_PARTNER)
AND (ISNULL(@P_NO_MEETING, '') = '' OR MT.NO_MEETING = @P_NO_MEETING)
AND (ISNULL(@P_ID_INSERT, '') = '' OR MT.ID_INSERT = @P_ID_INSERT)

GO