USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_SA_CUST_REL_MNG_PIC_COMMENT_S]    Script Date: 2017-06-08 오후 7:52:31 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO




ALTER PROCEDURE [NEOE].[SP_CZ_SA_MEETING_ATTENDEE_S]
(
	@P_CD_COMPANY	NVARCHAR(7),
	@P_NO_MEETING   NVARCHAR(20),
	@P_CD_PARTNER	NVARCHAR(20)
) 
AS
 
SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT AT.CD_COMPANY,
	   AT.NO_MEETING,
	   AT.TP_INOUT,
	   AT.CD_PARTNER,
	   AT.NO_INDEX,
	   AT.CD_COMPANY_ATTENDEE,
	   AT.NO_ATTENDEE,
	   AT.NM_ATTENDEE,
	   PR.NM_DEPT,
	   PR.NM_DUTY_RESP
FROM CZ_SA_MEETING_ATTENDEE AT
LEFT JOIN FI_PARTNERPTR PR ON PR.CD_COMPANY = AT.CD_COMPANY AND PR.CD_PARTNER = AT.CD_PARTNER AND PR.SEQ = AT.NO_ATTENDEE
WHERE AT.CD_COMPANY = @P_CD_COMPANY
AND AT.NO_MEETING = @P_NO_MEETING
AND AT.TP_INOUT = 'OUT'
AND AT.CD_PARTNER = @P_CD_PARTNER

SELECT AT.CD_COMPANY,
	   AT.NO_MEETING,
	   AT.TP_INOUT,
	   AT.NO_INDEX,
	   AT.CD_COMPANY_ATTENDEE,
	   MC.NM_COMPANY,
	   AT.NO_ATTENDEE,
	   AT.NM_ATTENDEE,
	   MD.NM_DEPT,
	   CD.NM_SYSDEF AS NM_DUTY_RANK
FROM CZ_SA_MEETING_ATTENDEE AT
LEFT JOIN MA_COMPANY MC ON MC.CD_COMPANY = AT.CD_COMPANY_ATTENDEE
LEFT JOIN MA_EMP ME ON ME.CD_COMPANY = AT.CD_COMPANY AND ME.NO_EMP = AT.NO_ATTENDEE
LEFT JOIN MA_DEPT MD ON MD.CD_COMPANY = ME.CD_COMPANY AND MD.CD_DEPT = ME.CD_DEPT
LEFT JOIN MA_CODEDTL CD ON CD.CD_COMPANY = ME.CD_COMPANY AND CD.CD_FIELD = 'HR_H000002' AND CD.CD_SYSDEF = ME.CD_DUTY_RANK
WHERE AT.CD_COMPANY = @P_CD_COMPANY
AND AT.NO_MEETING = @P_NO_MEETING
AND AT.TP_INOUT = 'IN'

GO