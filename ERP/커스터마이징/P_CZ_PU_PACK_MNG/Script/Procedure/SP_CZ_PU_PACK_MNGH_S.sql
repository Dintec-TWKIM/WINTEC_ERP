USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_PU_PACK_MNGH_S]    Script Date: 2016-07-05 오후 3:19:56 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[SP_CZ_PU_PACK_MNGH_S]
(
	@P_CD_COMPANY			NVARCHAR(7),
	@P_DT_FROM				NVARCHAR(8),
	@P_DT_TO				NVARCHAR(8),
	@P_NO_PO				NVARCHAR(20)
)
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT PH.CD_COMPANY,
	   CP.NM_COMPANY,
	   PH.NO_PO,
	   PH.NO_PACK,
	   PH.DT_PACK,
	   PH.CD_TYPE,
	   MC.NM_SYSDEF AS NM_TYPE,
	   PH.CD_SIZE,
	   MC1.NM_SYSDEF AS NM_SIZE,
	   PH.WEIGHT_GROSS,
	   PH.WEIGHT_NET,
	   PH.SIZE_X,
	   PH.SIZE_Y,
	   PH.SIZE_Z,
	   PH.CD_LOCATION,
	   MU.NM_USER AS NM_INSERT,
	   PH.DTS_INSERT,
	   MU1.NM_USER AS NM_UPDATE,
	   PH.DTS_UPDATE,
	   PH.DC_RMK
FROM CZ_PU_PACKH PH
LEFT JOIN MA_COMPANY CP ON CP.CD_COMPANY = PH.CD_COMPANY
LEFT JOIN MA_USER MU ON MU.CD_COMPANY = PH.CD_COMPANY AND MU.ID_USER = PH.ID_INSERT
LEFT JOIN MA_USER MU1 ON MU1.CD_COMPANY = PH.CD_COMPANY AND MU1.ID_USER = PH.ID_UPDATE
LEFT JOIN MA_CODEDTL MC ON MC.CD_COMPANY = PH.CD_COMPANY AND MC.CD_FIELD = 'CZ_SA00026' AND MC.CD_SYSDEF = PH.CD_TYPE
LEFT JOIN MA_CODEDTL MC1 ON MC1.CD_COMPANY = PH.CD_COMPANY AND MC1.CD_FIELD = MC.CD_FLAG1 AND MC1.CD_SYSDEF = PH.CD_SIZE
WHERE PH.DT_PACK BETWEEN @P_DT_FROM AND @P_DT_TO
AND (ISNULL(@P_CD_COMPANY, '') = '' OR PH.CD_COMPANY = @P_CD_COMPANY)
AND (ISNULL(@P_NO_PO, '') = '' OR PH.NO_PO LIKE @P_NO_PO + '%')

GO

