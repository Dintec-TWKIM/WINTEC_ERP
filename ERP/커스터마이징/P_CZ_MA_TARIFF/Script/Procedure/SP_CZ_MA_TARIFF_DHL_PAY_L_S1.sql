USE [NEOE]
GO

/****** Object:  StoredProcedure [NEOE].[SP_CZ_MA_TARIFF_DHL_PAY_L_S1]    Script Date: 2016-06-27 오후 5:01:58 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

ALTER PROCEDURE [NEOE].[SP_CZ_MA_TARIFF_DHL_PAY_L_S1]          
(  
	@P_CD_COMPANY		NVARCHAR(7),
	@P_DT_MONTH			NVARCHAR(6)
)  
AS

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED

SELECT PH.DT_MONTH,
	   SL.WEIGHT,
	   ROUND(SL.AM_ZONE1 + (SL.AM_ZONE1 * (PH.RT_FSC / 100)), 0) AS AM_ZONE1,
	   ROUND(SL.AM_ZONE2 + (SL.AM_ZONE2 * (PH.RT_FSC / 100)), 0) AS AM_ZONE2,
	   ROUND(SL.AM_ZONE3 + (SL.AM_ZONE3 * (PH.RT_FSC / 100)), 0) AS AM_ZONE3,
	   ROUND(SL.AM_ZONE4 + (SL.AM_ZONE4 * (PH.RT_FSC / 100)), 0) AS AM_ZONE4,
	   ROUND(SL.AM_ZONE5 + (SL.AM_ZONE5 * (PH.RT_FSC / 100)), 0) AS AM_ZONE5,
	   ROUND(SL.AM_ZONE6 + (SL.AM_ZONE6 * (PH.RT_FSC / 100)), 0) AS AM_ZONE6,
	   ROUND(SL.AM_ZONE7 + (SL.AM_ZONE7 * (PH.RT_FSC / 100)), 0) AS AM_ZONE7,
	   ROUND(SL.AM_ZONE8 + (SL.AM_ZONE8 * (PH.RT_FSC / 100)), 0) AS AM_ZONE8,
	   ROUND(SL.AM_ZONE9 + (SL.AM_ZONE9 * (PH.RT_FSC / 100)), 0) AS AM_ZONE9 
FROM CZ_MA_TARIFF_DHL_PAY_H PH
JOIN CZ_MA_TARIFF_DHL_STD_L SL ON SL.CD_COMPANY = PH.CD_COMPANY AND SL.DT_YEAR = SUBSTRING(PH.DT_MONTH, 1, 4) AND SL.TP_TARIFF = '001'
WHERE PH.CD_COMPANY = @P_CD_COMPANY
AND PH.DT_MONTH = @P_DT_MONTH

GO