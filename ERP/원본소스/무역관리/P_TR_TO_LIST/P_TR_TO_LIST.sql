IF EXISTS (SELECT * FROM dbo.sysobjects WHERE id = object_id(N'UP_TR_TO_LIST_SELECT') and OBJECTPROPERTY(id, N'IsProcedure') = 1)
DROP PROCEDURE UP_TR_TO_LIST_SELECT
GO 
/**********************************************************************************************************  
 * 프로시저명: UP_TR_TO_LIST_SELECT
 * 관련페이지: 
 * 작  성  자: 
 * EXEC UP_TR_TO_LIST_SELECT '',''
 *********************************************************************************************************/ 

CREATE PROC UP_TR_TO_LIST_SELECT 
(   
	@P_CD_COMPANY  NVARCHAR(7),  
	@P_DT_FROM   NVARCHAR(8),  
	@P_DT_TO   NVARCHAR(8),  
	@P_FG_LC   NVARCHAR(3),  
	@P_CD_PARTNER  NVARCHAR(7),   
	@P_CD_PURGRP  NVARCHAR(7)  
)  
AS 
BEGIN 
	SELECT 'N' CHK, A.NO_TO, A.DT_TO, A.CD_PARTNER, A.CD_EXCH, A.RT_EXCH, A.CD_PURGRP, A.NO_EMP,   
	C.LN_PARTNER, D.CD_SYSDEF NM_EXCH, E.NM_PURGRP, F.NM_KOR,   
	B.CD_ITEM, P.NM_ITEM, P.STND_ITEM, P.UNIT_IM, B.QT_TO, B.UM_EX, B.AM_EX, B.UM, B.AM, B.NO_BL, B.NO_BLLINE  
	FROM TR_TO_IMH A  
	INNER JOIN TR_TO_IML B ON B.CD_COMPANY = @P_CD_COMPANY AND B.NO_TO = A.NO_TO  
	LEFT OUTER JOIN MA_PARTNER C ON C.CD_COMPANY = @P_CD_COMPANY AND C.CD_PARTNER = A.CD_PARTNER  
	LEFT OUTER JOIN MA_CODEDTL D ON D.CD_COMPANY = @P_CD_COMPANY AND D.CD_FIELD = 'MA_B000005' /*--환종 */ AND D.CD_SYSDEF = A.CD_EXCH  
	LEFT OUTER JOIN MA_PURGRP E ON E.CD_COMPANY = @P_CD_COMPANY AND E.CD_PURGRP = A.CD_PURGRP  
	LEFT OUTER JOIN MA_EMP F ON F.CD_COMPANY = @P_CD_COMPANY AND F.NO_EMP = A.NO_EMP  
	LEFT OUTER JOIN MA_PITEM P ON P.CD_COMPANY = @P_CD_COMPANY AND P.CD_PLANT = B.CD_PLANT AND P.CD_ITEM = B.CD_ITEM  
	WHERE A.CD_COMPANY = @P_CD_COMPANY  
	AND A.DT_TO BETWEEN @P_DT_FROM AND @P_DT_TO  
	AND (A.FG_LC = @P_FG_LC OR @P_FG_LC = '' OR @P_FG_LC IS NULL)  
	AND (A.CD_PARTNER = @P_CD_PARTNER OR @P_CD_PARTNER = '' OR @P_CD_PARTNER IS NULL)  
	AND (A.CD_PURGRP = @P_CD_PURGRP OR @P_CD_PURGRP = '' OR @P_CD_PURGRP IS NULL)
 END
 GO  